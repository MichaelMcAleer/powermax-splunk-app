<form>
    <label>WLP Headroom</label>
    <search id="vmax_wlp_24hr_data">
        <query>`vmax_wlp_headroom` array_id=$array_tok$ srp=$srp_tok$
            emulation=$emulation_tok$
            workload_type=$workload_tok$ slo_name=$slo_tok$
            | fields array_id, srp, emulation, workload_type, slo_name,
            headroom_capacity, headroom_expiry_full,
            headroom_expiry_expiry_confidence
        </query>
        <earliest>$time_tok.earliest$</earliest>
        <latest>$time_tok.latest$</latest>
    </search>
    <fieldset submitButton="false">
        <input type="dropdown" token="array_tok" searchWhenChanged="true">
            <label>Array ID</label>
            <choice value="*">ALL</choice>
            <search>
                <query>`vmax_array` | dedup array_id | table array_id | sort
                    array_id
                </query>
                <earliest>$time_tok.earliest$</earliest>
                <latest>$time_tok.latest$</latest>
            </search>
            <fieldForLabel>array_id</fieldForLabel>
            <fieldForValue>array_id</fieldForValue>
            <default>*</default>
        </input>
        <input type="dropdown" token="srp_tok" searchWhenChanged="true">
            <label>SRP ID</label>
            <choice value="*">ALL</choice>
            <search>
                <query>`vmax_srp` array_id=$array_tok$
                    | dedup srp_id | table srp_id | sort srp_id
                </query>
                <earliest>$time_tok.earliest$</earliest>
                <latest>$time_tok.latest$</latest>
            </search>
            <fieldForLabel>srp_id</fieldForLabel>
            <fieldForValue>srp_id</fieldForValue>
            <default>*</default>
        </input>
        <input type="dropdown" token="emulation_tok" searchWhenChanged="true">
            <label>Emulation Type</label>
            <choice value="*">ALL</choice>
            <search>
                <query>`vmax_wlp_headroom` array_id=$array_tok$ srp=$srp_tok$
                    | dedup emulation | table emulation | sort emulation
                </query>
                <earliest>$time_tok.earliest$</earliest>
                <latest>$time_tok.latest$</latest>
            </search>
            <fieldForLabel>emulation</fieldForLabel>
            <fieldForValue>emulation</fieldForValue>
            <default>*</default>
        </input>
        <input type="dropdown" token="slo_tok" searchWhenChanged="true">
            <label>Service Level</label>
            <choice value="*">ALL</choice>
            <search>
                <query>`vmax_wlp_headroom` array_id=$array_tok$ srp=$srp_tok$
                    emulation=$emulation_tok$
                    | dedup slo_name | table slo_name | sort slo_name
                </query>
                <earliest>$time_tok.earliest$</earliest>
                <latest>$time_tok.latest$</latest>
            </search>
            <fieldForLabel>slo_name</fieldForLabel>
            <fieldForValue>slo_name</fieldForValue>
            <default>*</default>
        </input>
        <input type="dropdown" token="workload_tok" searchWhenChanged="true">
            <label>Workload Type</label>
            <choice value="*">ALL</choice>
            <search>
                <query>`vmax_wlp_headroom` array_id=$array_tok$ srp=$srp_tok$
                    emulation=$emulation_tok$
                    slo_name=$slo_tok$
                    | dedup workload_type | table workload_type | sort
                    workload_type
                </query>
                <earliest>$time_tok.earliest$</earliest>
                <latest>$time_tok.latest$</latest>
            </search>
            <fieldForLabel>workload_type</fieldForLabel>
            <fieldForValue>workload_type</fieldForValue>
            <default>*</default>
        </input>
        <input type="time" token="time_tok" searchWhenChanged="true">
            <label>Time Frame</label>
            <default>
                <earliest>-24h</earliest>
                <latest>now</latest>
            </default>
        </input>
    </fieldset>
    <row>
        <panel>
            <title>Headroom Capacity by Workload Type</title>
            <chart>
                <search base="vmax_wlp_24hr_data">
                    <query>timechart avg(headroom_capacity) by workload_type
                        usenull=f useother=f
                    </query>
                </search>
                <option name="charting.axisTitleX.visibility">collapsed
                </option>
                <option name="charting.axisTitleY.visibility">collapsed
                </option>
                <option name="charting.chart">line</option>
                <option name="charting.chart.nullValueMode">zero</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
        <panel>
            <title>Headroom Expiry - Days Until Full</title>
            <chart>
                <search base="vmax_wlp_24hr_data">
                    <query>timechart avg(headroom_expiry_full) by workload_type
                        usenull=f useother=f
                    </query>
                </search>
                <option name="charting.axisTitleX.visibility">collapsed
                </option>
                <option name="charting.axisTitleY.visibility">collapsed
                </option>
                <option name="charting.chart">line</option>
                <option name="charting.chart.nullValueMode">zero</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
    </row>
    <row>
        <panel>
            <title>Workload Headroom Summary</title>
            <table>
                <search>
                    <query>`vmax_wlp_headroom` array_id=$array_tok$
                        srp=$srp_tok$ emulation=$emulation_tok$
                        workload_type=$workload_tok$ slo_name=$slo_tok$
                        | head 10000 | dedup array_id, srp, emulation,
                        workload_type, slo_name
                        | table array_id, srp, emulation, workload_type,
                        slo_name, last_timestamp, headroom_capacity,
                        headroom_expiry_full, headroom_expiry_expiry_confidence
                        | sort array_id, srp, emulation, workload_type,
                        slo_name
                        | rename array_id as "Array ID", srp as "SRP ID",
                        emulation as "Emulation", workload_type as
                        "Workload Type", slo_name as "Service Level",
                        last_timestamp as "Last Timestamp",
                        headroom_capacity
                        as "Headroom Capacity", headroom_expiry_full as
                        "Headroom Expiry Days Until Full",
                        headroom_expiry_expiry_confidence as "Headroom Expiry
                        Confidence"
                    </query>
                    <earliest>-15m</earliest>
                    <latest>now</latest>
                </search>
                <option name="drilldown">none</option>
            </table>
        </panel>
    </row>
</form>